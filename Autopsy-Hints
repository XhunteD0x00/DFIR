Basic workflow

    Create/open the case for the data source you will investigate
    Select the data source you wish to analyze
    Configure the ingest modules to extract specific artifacts from the data source
    Review the artifacts extracted by the ingest modules
    Create the report

Case Analysis | Create a New Case

To prepare a new case investigation, you need to create a case file from the data source. When you start the Autopsy, you will have three options. You can create a new case file using the New Case option. Once you click on the "New Case" option, the Case Information menu opens, where information about the case is populated.

    Case Name: The name you wish to give to the case
    Base Directory: The root directory that will store all the files specific to the case (the full path will be displayed)
    Case Type: Specify whether this case will be local (Single-User) or hosted on a server where multiple analysts can review (Multi-User)

Note: In this room, the focus is on Single-User. Also, the room doesn't simulate a new case creation, and the given VM already has a sample case file on the Desktop (as demonstrated below) to practice covered Autopsy features.

Case Analysis | Open an Existing Case

The Autopsy can also open prebuilt case files. Note that supported data sources are discussed in the next task. This part will show how to create/open case files with Autopsy.

Note: Autopsy case files have a .aut file extension.

In this room, you will import a case. To open a case, select the "Open Case" option. Navigate to the case folder (located on the Desktop) and select the .aut file you wish to open. Next, Autopsy will process the case files and open the case.


Note: If Autopsy cannot locate the disk image, a warning box will appear. At this point, you can point to the location of the disk image it's attempting to find, or you can click No; you can still analyze the data from the Autopsy case.



Data Sources

Autopsy can analyze multiple disk image formats. Before diving into the data analysis step, let's briefly cover the different data sources Autopsy can analyze.
You can add data sources using the Add Data Source button. 

We will focus primarily on the Disk Image or VM File option in this room.

Supported Disk Image Formats:

    Raw Single (For example: *.img, *.dd, *.raw, *.bin)
    Raw Split (For example: *.001, *.002, *.aa, *.ab, etc)
    EnCase (For example: *.e01, *.e02, etc)
    Virtual Machines (For example: *.vmdk, *.vhd)

If there are multiple image files (e.g., E01, E02, E03, etc.), Autopsy only needs you to point to the first image file; it will handle the rest.  

Note: Refer to the Autopsy documentation to understand the other data sources that can be added to a case. 

Ingest Modules

Essentially, Ingest Modules are Autopsy plug-ins. Each Ingest Module is designed to analyze and retrieve specific data from the drive. You can configure Autopsy to run specific modules during the source-adding stage or later by choosing the target data source available on the dashboard. By default, the Ingest Modules are configured to run on All Files, Directories, and Unallocated Space. You can change this setting during the module selecting step. You can track the process by clicking the bar in the lower right corner.

We have demonstrated two different approaches to using the ingest modules in this task.

While Adding Data Sources

One of the ways to configure the ingest modules is to enable/disable them while adding a data source in Autopsy. This is a straightforward process, as you get this option while adding a data source. 


After Adding Data Sources

Another method of configuring the ingest modules is configuring them on a pre-loaded disk. This can be done by following the steps given below:

    Open the "Run Ingest Modules" menu by right-clicking on the data source.
    Choose the modules to implement and click on the finish button.
    Track the progress of implementation.

The results of any Ingest Module you select to run against a data source will populate the Results node in the Tree view,
which is the left pane of the Autopsy user interface. Below is an example of using the Interesting Files Identifier ingest module. Note that the results depend on the dataset. If you choose a module to retrieve specific data that is unavailable in the drive, there will be no results.


The User Interface I

Let's look at the Autopsy user interface, which is comprised of 5 primary areas:

Tree Viewer

The Tree Viewer has five top-level nodes:

Autopsy - Tree view

    Data Sources- All the data will be organized as typically seen in a normal Windows File Explorer. 
    Views- Files will be organized based on the file types, MIME types, file size, etc. 
    Results- As mentioned earlier in the previous task, this is where the results from Ingest Modules will appear. 
    Tags- It will display files and/or results that have been tagged (read more about tagging here).
    Reports- It will display reports either generated by modules or the analyst (read more about reporting here).

Result Viewer

Note: Don't confuse the Results node (from the Tree Viewer) with the Result Viewer.

When a volume, file, folder, etc., is selected from the Tree Viewer, additional information about the selected item is displayed in the Result Viewer.
For example, the sample case's data source is selected, and additional information is now visible in the Results Viewer.

Notice that the Result Viewer pane has three tabs: Table, Thumbnail, and Summary.
The above screenshots reflect the information displayed in the Table tab. The Thumbnail tab works best with image or video files.
If the view of the above data is changed from Table to Thumbnail, not much information will be displayed. See below.

Notice that the Result Viewer pane has three tabs: Table, Thumbnail, and Summary. The above screenshots reflect the information displayed in the Table tab. The Thumbnail tab works best with image or video files.
If the view of the above data is changed from Table to Thumbnail, not much information will be displayed. See below.



In the Views tree node, files are categorized by File Types: By Extension, By MIME Type, By Deleted Files, and By File Size.

Multipurpose Internet Mail Extensions (MIME) is an Internet standard that extends the format of email messages to support text in character sets other than ASCII, as well as attachments of audio, video, images, and application programs.


خد بالك من النقطة اللي جاية دي مهمة جدا : 
Tip: When it comes to File Types, pay attention to this section.
An adversary can rename a file with a misleading file extension, so the file will be 'miscategorized' By Extension but will be categorized appropriately By MIME Type.
Expand By Extension, and more children nodes appear, categorizing files further (see below).



In the image given above, three columns might not be quickly understood for what they represent.

    S = Score

The Score will show a red exclamation point for a folder/file marked/tagged as notable and a yellow triangle pointing downward for a folder/file marked/tagged as suspicious. An Ingest Module or the analyst can mark/tag these items.


    C = Comment

If a yellow page is visible in the Comment column, it will indicate that there is a comment for the folder/file.


    O = Occurrence

In a nutshell, this column will indicate how many times this file/folder has been seen in past cases (this will require the Central Repository)

Refer to the Autopsy documentation on the Contents Viewer for more information here.





The User Interface II

Let's look at where we can easily find summarised information. Summarised information can help analysts decide where to focus by evaluating available artifacts.
It is suggested that you view the summary of the data sources before starting an investigation. This will give you a general idea about the system and artifacts.

Data Sources Summary

The Data Sources Summary provides summarised info in nine different categories.
Note that this is an overview of the total findings.
If you want to dive deep into the findings and look for a specific artifact, you need to analyze each module separately using the Result Viewer shown in the previous task.


Generate Report

You can create a report of your findings in multiple formats, enabling you to create data sheets for your investigation case. The report provides all the information listed under the Result Viewer pane. Reports can help you re-investigate the findings after finishing the live investigation. However, reports don't have additional search options, so you must manually find artifacts for the event of interest.

Tip: The Autopsy tool can be heavy for systems with low resources. Therefore, completing an investigation with Autopsy on low resources can be slow and painful. Browsing long results might end up with a system freeze. You can avoid that situation by using reports. You can use the tool to parse the data and generate the report, then continue to analyze through the generated report without a need for Autopsy. Note that it is always easier to conduct and manage an investigation with the GUI.

You can use the Generate Report option to create reports. The steps are shown below.


Visualization Tools

You may have noticed that other parts of the user interface haven't been discussed yet.

Autopsy - Top bar

Please refer to the Autopsy documentation for the following visualization tool:

    Images/Videos:http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/image_gallery_page.html
    Communications:http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/communications_page.html
    Timeline:http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/timeline_page.html

Note: You can not practice with some visualization tools within the attached VM, except for Timeline. Below is a screenshot of the Timeline.

The Timeline tool is composed of three areas:

    Filters: Narrow the events displayed based on the filter criteria
    Events: The events are displayed here based on the View Mode
    Files/Contents: Additional information on the event(s) is displayed in this area

There are three view modes:

    Counts: The number of events is displayed in a bar chart view
    Details: Information on events is displayed, but they are clustered and collapsed, so the UI is not overloaded
    List: The events are displayed in a table view

The View Mode in the above screenshot is Counts. Below is a screenshot of the Details View Mode.








Test :

1-Expand the "Data Sources" option; what is the number of available sources?  عد عندك كام volume
2-What is the number of the detected "Removed" files? Removed files can be found under the "Recycle Bin" category  from Results search for Exctracted-content in Recycle Bin ملحوظة برضوا دا المكان اللي بيظهر لنا 
3-What is the filename found under the "Interesting Files" section? طبعا دي سهلة 

4-What is the full name of the operating system version?  generate report and view case summery or 
click right on the data-source and view summary then you well know the OS-info و في طرق كتيره 

5-What percentage of the drive are documents? Include the % in your answer.  من View summary also
6-Generate an HTML report as shown in the task and view the "Case Summary" section.
What is the job number of the "Interesting Files Identifier" module? وضحه زي الشمس 

7-What is the name of an Installed Program with the version number of 6.2.0.2962? from installed Program بس طبعا لازم ترن ال plugins
8- A user has a Password Hint. What is the value?   from operating system user-accounts
9-Numerous SECRET files were accessed from a network drive. What was the IP address? from Recent Docuemnts you will see it as shared-folder and its IP-Address
10-What web search term has the most entries? from Web Search icon search for Text and look at the text that the user put it  يعني النص اللي يوزر كان بيدخله كتير
11-What was the web search conducted on 3/25/2015 21:46:44?  same as above
12-What MD5 hash value of the binary is listed as an Interesting File?
13-What MD5 hash value of the binary is listed as an Interesting File? from Interesting File search there for MD5
14-What self-assuring message did the 'Informant' write for himself on a Sticky Note? this is a user i think you know where to find

15-What self-assuring message did the 'Informant' write for himself on a Sticky Note? (no spaces) السوال دا ابن كلب ممكن تجبها من كل حته عشان دي sticky note  وطبعا ال MIME هيقدر  يلقطها بس هتجبيها من السيرش عليها او 
from Extension Mismatch Detected and search for it and click on it twice will open it's location and read it from Viwer Result

